local Zellen = {}
Zellen[1] = false
Zellen[2] = false
Zellen[3] = false
Zellen[4] = false
Zellen[5] = false
Zellen[6] = false
Zellen[7] = false
Zellen[8] = false
Zellen[9] = false
Zellen[10] = false
Zellen[11] = false
Zellen[12] = false
Zellen[13] = false
Zellen[14] = false
Zellen[15] = false
Zellen[16] = false
Zellen[17] = false
Zellen[18] = false
Zellen[19] = false
Zellen[20] = false
Zellen[21] = false
Zellen[22] = false
Zellen[23] = false
Zellen[24] = false
Zellen[25] = false
Zellen[26] = false
Zellen[27] = false
Zellen[28] = false
Zellen[29] = false
Zellen[30] = false
Zellen[31] = false

local CellKoords = {}

for i=1, 31, 1 do

	CellKoords[i] = {}

end

CellKoords[1]["x"], CellKoords[1]["y"], CellKoords[1]["z"], CellKoords[1]["rot"] = 2426.2802734375, -1286.552734375, 994.54663085938, 0
CellKoords[2]["x"], CellKoords[2]["y"], CellKoords[2]["z"], CellKoords[2]["rot"] = 2430.2585449219, -1286.3759765625, 994.54663085938, 0
CellKoords[3]["x"], CellKoords[3]["y"], CellKoords[3]["z"], CellKoords[3]["rot"] = 2433.9345703125, -1286.7724609375, 994.54663085938, 0
CellKoords[4]["x"], CellKoords[4]["y"], CellKoords[4]["z"], CellKoords[4]["rot"] = 2438.271484375, -1286.47265625, 994.54663085938, 0
CellKoords[5]["x"], CellKoords[5]["y"], CellKoords[5]["z"], CellKoords[5]["rot"] = 2442.1767578125, -1286.5126953125, 994.54663085938, 0
CellKoords[6]["x"], CellKoords[6]["y"], CellKoords[6]["z"], CellKoords[6]["rot"] = 2446.14453125, -1286.4384765625, 994.54663085938, 0
CellKoords[7]["x"], CellKoords[7]["y"], CellKoords[7]["z"], CellKoords[7]["rot"] = 2450.3330078125, -1286.3212890625, 994.54663085938, 0

CellKoords[8]["x"], CellKoords[8]["y"], CellKoords[8]["z"], CellKoords[8]["rot"] = 2426.10546875, -1286.1669921875, 988.19055175781, 0
CellKoords[9]["x"], CellKoords[9]["y"], CellKoords[9]["z"], CellKoords[9]["rot"] = 2430.3154296875, -1286.5556640625, 988.19055175781, 0
CellKoords[10]["x"], CellKoords[10]["y"], CellKoords[10]["z"], CellKoords[10]["rot"] = 2433.9326171875, -1286.6484375, 988.19055175781, 0
CellKoords[11]["x"], CellKoords[11]["y"], CellKoords[11]["z"], CellKoords[11]["rot"] = 2438.1279296875, -1286.4072265625, 988.19055175781, 0
CellKoords[12]["x"], CellKoords[12]["y"], CellKoords[12]["z"], CellKoords[12]["rot"] = 2442.373046875, -1286.78515625, 988.19055175781, 0
CellKoords[13]["x"], CellKoords[13]["y"], CellKoords[13]["z"], CellKoords[13]["rot"] = 2445.7314453125, -1286.3681640625, 988.19055175781, 0
CellKoords[14]["x"], CellKoords[14]["y"], CellKoords[14]["z"], CellKoords[14]["rot"] = 2450.078125, -1286.4755859375, 988.19055175781, 0

CellKoords[15]["x"], CellKoords[15]["y"], CellKoords[15]["z"], CellKoords[15]["rot"] = 2450.125, -1262.5888671875, 988.19055175781, 180
CellKoords[16]["x"], CellKoords[16]["y"], CellKoords[16]["z"], CellKoords[16]["rot"] = 2446.1611328125, -1262.822265625, 988.19055175781, 180
CellKoords[17]["x"], CellKoords[17]["y"], CellKoords[17]["z"], CellKoords[17]["rot"] = 2442.3681640625, -1262.9775390625, 988.19055175781, 180
CellKoords[18]["x"], CellKoords[18]["y"], CellKoords[18]["z"], CellKoords[18]["rot"] = 2438.1865234375, -1262.5302734375, 988.19055175781, 180
CellKoords[19]["x"], CellKoords[19]["y"], CellKoords[19]["z"], CellKoords[19]["rot"] = 2434.0068359375, -1262.2841796875, 988.19055175781, 180
CellKoords[20]["x"], CellKoords[20]["y"], CellKoords[20]["z"], CellKoords[20]["rot"] = 2430.2197265625, -1262.7744140625, 988.19055175781, 180
CellKoords[21]["x"], CellKoords[21]["y"], CellKoords[21]["z"], CellKoords[21]["rot"] = 2426.4345703125, -1262.283203125, 988.19055175781, 180

CellKoords[22]["x"], CellKoords[22]["y"], CellKoords[22]["z"], CellKoords[22]["rot"] = 2450.3408203125, -1262.4375, 994.54632568359, 180
CellKoords[23]["x"], CellKoords[23]["y"], CellKoords[23]["z"], CellKoords[23]["rot"] = 2446.36328125, -1262.6083984375, 994.54638671875, 180
CellKoords[24]["x"], CellKoords[24]["y"], CellKoords[24]["z"], CellKoords[24]["rot"] = 2442.0654296875, -1262.55078125, 994.54638671875, 180
CellKoords[25]["x"], CellKoords[25]["y"], CellKoords[25]["z"], CellKoords[25]["rot"] = 2437.9384765625, -1262.4052734375, 994.54632568359, 180
CellKoords[26]["x"], CellKoords[26]["y"], CellKoords[26]["z"], CellKoords[26]["rot"] = 2434.0771484375, -1262.84375, 994.54638671875, 180
CellKoords[27]["x"], CellKoords[27]["y"], CellKoords[27]["z"], CellKoords[27]["rot"] = 2430.140625, -1262.0654296875, 994.54632568359, 180
CellKoords[28]["x"], CellKoords[28]["y"], CellKoords[28]["z"], CellKoords[28]["rot"] = 2426.212890625, -1262.0224609375, 994.546875, 180

CellKoords[29]["x"], CellKoords[29]["y"], CellKoords[29]["z"], CellKoords[29]["rot"] = 2462.5810546875, -1262.0634765625, 988.19055175781, 180
CellKoords[30]["x"], CellKoords[30]["y"], CellKoords[30]["z"], CellKoords[30]["rot"] = 2466.3837890625, -1261.81640625, 988.19055175781, 180
CellKoords[31]["x"], CellKoords[31]["y"], CellKoords[31]["z"], CellKoords[31]["rot"] = 2470.53125, -1262.1376953125, 988.19055175781, 180

local bailCosts = { 1000, 2000, 3000, 5000, 7000, 10000 }

addEvent ( "onPlayerGetsFreed", true )
local playerCelled = {}

function getFreeCell ( )
	local va = false
	local num = false
	local vale = 0		
	while va == false do
		if vale == 31 then
			return false
		end
		num = math.random ( 1, 31 )
		if Zellen[num] == false then
			va = true
			return num
		end
		vale = vale+1
	end
end


function getCellCoords ( count )
	if count == false then
		return 2443.1318359375, -1274.8173828125, 988.19055175781, 110
	end
	return CellKoords[count]["x"], CellKoords[count]["y"], CellKoords[count]["z"], CellKoords[count]["rot"]
end


function cellHandlerFunc ( player )
	local player = isElement ( player ) and player or source	
	local cell = playerCelled[player]
	if cell then
		Zellen[cell] = false
	end
	playerCelled[player] = nil
	removeEventHandler ( "onPlayerGetsFreed", player, cellHandlerFunc )
	removeEventHandler ( "onPlayerQuit", player, cellHandlerFunc )
	removeEventHandler ( "onPlayerWasted", player, cellHandlerFunc )
end


function putPlayerInFreeCell ( player )

	local cell = getFreeCell()
	
	if cell == false then
	else
		Zellen[cell] = getPlayerName ( player )
		playerCelled[player] = cell
		removeEventHandler ( "onPlayerGetsFreed", player, cellHandlerFunc )
		removeEventHandler ( "onPlayerQuit", player, cellHandlerFunc )
		removeEventHandler ( "onPlayerWasted", player, cellHandlerFunc )
		addEventHandler ( "onPlayerGetsFreed", player, cellHandlerFunc )
		addEventHandler ( "onPlayerQuit", player, cellHandlerFunc )
		addEventHandler ( "onPlayerWasted", player, cellHandlerFunc )
	end
	local x, y, z, rz = getCellCoords ( cell )
	
	setElementPosition ( player, x, y, z )
	setElementRotation ( player, 0, 0, rz )
	setElementInterior ( player, 2 )
	
end

LVJailArea = createColCuboid ( 2278.166015625, 2424.8486328125, 3.0, 6.799804685, 10.05, 4.08400478363 )
local sfprisonjail = createColSphere ( 2421.4072265625, -1273.099609375, 988.19055175781, 5 )

function isInLVJailArea ( player )

	local x1, y1, z1 = getElementPosition ( player )
	if getDistanceBetweenPoints3D ( x1, y1, z1, 198.08735656738, 174.32916259766, 1002.672668457 ) < 10 then
		return true
	else
		return false
	end
end
function isInSFJailArea ( player )

	--[[local x, y, z = getElementPosition ( player )
	if x < 229 and x > 213 and y < 116 and y > 107 and z < 1002 and z > 950 then
		return true
	else
		return false
	end]]
	
	return isElementWithinColShape ( player, sfprisonjail )
end

function isInSFCarJailArea ( player )

	local x, y, z = getElementPosition ( player )
	if getDistanceBetweenPoints3D ( -1590, 716, 0, x, y, 0 ) < 6.5 then
		return true
	else
		return false
	end
end
function isInLVCarJailArea ( player )

	return isElementWithinColShape ( player, LVJailArea )
end


function arrest_func ( player )
	local arrest_wanteds = tonumber(vnxGetElementData( player, "wanteds" ))
	local time
	local fine
	local kaution
	local targetfrac = vnxGetElementData( player, "fraktion" )
	local arrester = nil
				
	-----------------------------------------------------
					
	if evilFraction[targetfrac] then
		time = arrest_wanteds * math.ceil(jailtimeperwanted * 0.8)
		fine = 150 * arrest_wanteds
		kaution = bailCosts[arrest_wanteds]
	else
		time = arrest_wanteds * math.ceil(jailtimeperwanted)
		fine = 200 * arrest_wanteds
		kaution = 0
	end
				
	----------------------------------------------------------------
					
	local veh = getPedOccupiedVehicle ( player )
	if isElement ( veh ) then
		arrester = getVehicleController ( veh )
		vnxSetElementData ( player, "arrester", arrester )
		removePedFromVehicle ( player ) 	
	end

	local boolean = not vnxGetElementData ( player, "tied" )
	if boolean then 
		local fix = "ent" 
		vnxSetElementData ( player, "tied", boolean )
		toggleAllControls ( player, boolean )
		fadeCamera ( player, true, 0.5, 0, 0, 0 )
		removeEventHandler ( "onPlayerCommand", player, block_tie_cmds )
	end
	if vnxGetElementData ( player, "jailtime" ) > 0 then
		cellHandlerFunc ( player )
	end
	arrestPlayer ( arrester, player, time, fine, kaution )						
end


function ausknastenAusKnast ( player, cmd, targetname )
	if isStateFaction ( player ) or isAdminLevel ( player, 5 ) then
		if isOnDuty ( player ) or isAdminLevel ( player, 5 ) then
			if getPlayerRank ( player ) >= 3 or isAdminLevel ( player, 5 ) then
				if targetname then
					local target = findPlayerByName( targetname )
					if target then
						if vnxGetElementData ( target, "jailtime" ) > 0 and vnxGetElementData ( target, "prison" ) == 0 then
							freePlayerFromJail ( target )
							local msg = "Der Spieler "..getPlayerName(target).." wurde von "..getPlayerName(player).." ausgeknastet."
							sendMSGForFaction ( msg, 1, 0, 0, 155 )
							sendMSGForFaction ( msg, 6, 0, 0, 155 )
							sendMSGForFaction ( msg, 8, 0, 0, 155 )
							outputLog ( getPlayerName(target).."wurde von "..getPlayerName(player).." ausgeknastet.", "knast" )
						else
							triggerClientEvent ( player, "infobox_start", getRootElement(), "Der Spieler ist\nnicht im Knast!", 5000, 125, 0, 0 )
						end
					else
						triggerClientEvent ( player, "infobox_start", getRootElement(), "Der Spieler existiert\nnicht oder ist\noffline!", 5000, 125, 0, 0 )
					end
				else
					triggerClientEvent ( player, "infobox_start", getRootElement(), "Gebrauch:\n/ausknasten [Name]", 5000, 125, 0, 0 )
				end
			else
				triggerClientEvent ( player, "infobox_start", getRootElement(), "Ab Rang 5", 5000, 125, 0, 0 )
			end
		else
			triggerClientEvent ( player, "infobox_start", getRootElement(), "Du musst\nOnduty sein!", 5000, 125, 0, 0 )
		end
	else
		triggerClientEvent ( player, "infobox_start", getRootElement(), "Du bist nicht befugt!", 5000, 125, 0, 0 )
	end	
end
addCommandHandler ( "ausknasten", ausknastenAusKnast )

function arrestPlayer ( officer, player, time, fine, bail )
	local money = vnxGetElementData ( player, "money" )
	if fine > money then		
		vnxSetElementData ( player, "money", 0 )
	else
		vnxSetElementData ( player, "money", money - fine )
	end
	if vnxGetElementData ( player, "tied" ) then
		fadeCamera ( player, true, 0.5, 0, 0, 0 )
		toggleAllControls ( player, true )
	end
	vnxSetElementData ( player, "jailtime", time )
	if officer then
		vnxSetElementData ( officer, "boni", vnxGetElementData ( officer, "boni" ) + vnxGetElementData ( player, "wanteds" ) * wantedarrestmoney )
	end
	if bail == nil then bail = 1 end
	if bail == 0 then
		vnxSetElementData ( player, "bail", 0 )
		if officer then
			outputChatBox ( "Du hast den Spieler "..getPlayerName ( player ).." ohne Kaution für "..fine.." $ und "..time.." Minuten eingesperrt!", officer, 0, 125, 0 )
			outputChatBox ( "Du wurdest vom Staatsfraktionisten "..getPlayerName ( officer ).." ohne Kaution für "..fine.." $ und "..time.." Minuten eingesperrt!", player, 0, 125, 0 )
		else
			outputChatBox ( "Du wurdest ohne Kaution für "..fine.." $ und "..time.." Minuten eingesperrt!", player, 0, 125, 0 )
		end
	else
		vnxSetElementData ( player, "bail", bail )
		if officer then
			outputChatBox ( "Du wurdest vom Staatsfraktionisten "..getPlayerName ( officer ).." mit "..bail.." $ Kaution für "..fine.." $ und "..time.." Minuten eingesperrt!", player, 0, 125, 0 )
			outputChatBox ( "Du hast den Spieler "..getPlayerName ( player ).." mit "..bail.." $ Kaution für "..fine.." $ und "..time.." Minuten eingesperrt!", officer, 0, 125, 0 )
		else
			outputChatBox ( "Du wurdest mit "..bail.." $ Kaution für "..fine.." $ und "..time.." Minuten eingesperrt!", player, 0, 125, 0 )
		end
	end
	vnxSetElementData ( player, "AnzahlImKnast", vnxGetElementData ( player, "AnzahlImKnast" ) + 1 )
	if officer then
		outputChatBox ( getPlayerRankName ( officer ).." "..getPlayerName ( officer ).." hat "..getPlayerName ( player ).." eingesperrt!", getRootElement(), 0, 0, 150 )
		outputLog ( getPlayerRankName ( officer ).." "..getPlayerName ( officer ).." hat "..getPlayerName ( player ).." eingesperrt!", "knast" )
		vnxSetElementData ( officer, "AnzahlEingeknastet", vnxGetElementData ( officer, "AnzahlEingeknastet" ) + 1 )
	else
		outputChatBox ( getPlayerName ( player ).." wurde eingesperrt!", getRootElement(), 0, 0, 150 )
	end	
	putPlayerInJail ( player )
end


local knast_cmds = {}
knast_cmds["smoke"] = true
knast_cmds["usedrugs"] = true
knast_cmds["sellgun"] = true

function disbaleKnastCMD ( cmd )
	if knast_cmds[cmd] then
		cancelEvent()
	end
end

function putPlayerInJail ( player )
	takeAllWeapons ( player )
	vnxSetElementData ( player, "wanteds", 0 )
	setPlayerWantedLevel ( player, 0 )
	triggerClientEvent ( player, "jailKeyDisable", player )
	
	putPlayerInFreeCell ( player )
	removeEventHandler( "onPlayerCommand", player, disbaleKnastCMD )
	addEventHandler( "onPlayerCommand", player, disbaleKnastCMD )
	setElementDimension ( player, 0 )
end


function bail_func ( player )
	if vnxGetElementData ( player, "jailtime" ) == 0 then
		triggerClientEvent ( player, "infobox_start", getRootElement(), "\nDu bist nicht\nim Gefängnis!", 5000, 125, 0, 0 )
	else
		if vnxGetElementData ( player, "bail" ) == 0 or vnxGetElementData ( player, "prison" ) > 0 then
			triggerClientEvent ( player, "infobox_start", getRootElement(), "\nDu hast\nkeine Kaution!", 5000, 125, 0, 0 )
		else
			local bail = vnxGetElementData ( player, "bail" )
			local money = vnxGetElementData ( player, "money" )
			if bail <= money then
				vnxSetElementData ( player, "money", money - bail )
				freePlayerFromJail ( player )
				if isElement ( vnxGetElementData ( player, "arrester" ) ) then
					local arrester = vnxGetElementData ( player, "arrester" )
					vnxSetElementData ( player, "arrester", nil )
					vnxSetElementData ( arrester, "money", vnxGetElementData ( arrester, "money" ) + bail/12 )
					outputChatBox ( getPlayerName(player).." hat die Kaution bezahlt, du bekommst "..bail/12 .."$", arrester, 0, 200, 0 )
				end
				vnxSetElementData ( player, "arrester", nil )
			else 
				local bankmoney = vnxGetElementData ( player, "bankmoney" )
				if bail <= money + bankmoney then
					local rest = bail - money
					vnxSetElementData ( player, "money", 0 )
					vnxSetElementData ( player, "bankmoney", bankmoney - rest )
					freePlayerFromJail ( player )
					if isElement ( vnxGetElementData ( player, "arrester" ) ) then
						local arrester = vnxGetElementData ( player, "arrester" )
						vnxSetElementData ( player, "arrester", nil )
						vnxSetElementData ( arrester, "money", vnxGetElementData ( arrester, "money" ) + bail/12 )
						outputChatBox ( getPlayerName(player).." hat die Kaution bezahlt, du bekommst "..bail/12 .."$", arrester, 0, 200, 0 )
					end
				else
					infobox ( player, "Du hast\nzu wenig Geld!\nKosten:\n"..bail, 5000, 125, 0, 0 )
				end
			end
		end
	end
end
addCommandHandler ( "bail", bail_func )	


function freePlayerFromJail ( player )
	removeEventHandler ( "onPlayerCommand", player, disbaleKnastCMD )
	triggerEvent ( "onPlayerGetsFreed", player, player )
	vnxSetElementData ( player, "jailtime", 0 )
	vnxSetElementData ( player, "prison", 0 )
	vnxSetElementData ( player, "bail", 0 )
	vnxSetElementData ( player, "arrester", nil )
	toggleControl ( player, "enter_exit", true )
	toggleControl ( player, "fire", true )
	toggleControl ( player, "jump", true )
	toggleControl ( player, "action", true )
	if vnxGetElementData ( player, "heaventime" ) == 0 then
		infobox ( player, "Du bist wieder\nfrei! Benimm dich\nin Zukunft besser!", 5000, 0, 200, 0 )
		setElementInterior ( player, 0 )
		setElementPosition ( player, -1605.675, 717.516, 12.006 )
	end
end


function jailtime_func ( player )
	local jailtime = vnxGetElementData ( player, "jailtime" )
	if jailtime == 0 then
		local prisontime = vnxGetElementData ( player, "prison" )
		if prisontime == 0 then
			infobox ( player, "\nDu bist nicht\nim Gefängnis!", 5000, 125, 0, 0 )
		else
			outputChatBox ("Du bist noch für "..prisontime.." Minuten im Prison!", player, 0, 125, 0 )
		end
	else
		outputChatBox ("Du bist noch für "..jailtime.." Minuten im Gefängnis!", player, 0, 125, 0 )
	end
end
addCommandHandler ( "jailtime", jailtime_func )


local stellenmarker = createPickup ( 241.2525, 113.0535, 1002.9187, 3, 1239, 50 )
setElementInterior ( stellenmarker, 10 )
local stellenAn = true
local stellenTimer = nil

addEventHandler ( "onPickupHit", stellenmarker, function (player)
	infobox ( player, "Hier kannst du\ndich mit\n/ergeben stellen.", 5000, 0, 200, 0 )
end )

function stellen_func ( player )
	if vnxGetElementData ( player, "wanteds" ) > 0 then
		if vnxGetElementData ( player, "jailtime" ) == 0 and vnxGetElementData ( player, "prison" ) == 0 then
			if getElementInterior ( player ) == 10 then
				if stellenAn then
					local x, y, z = getElementPosition ( player )
					local x1, y1, z1 = getElementPosition ( stellenmarker )
					if getDistanceBetweenPoints3D ( x, y, z, x1, y1, z1 ) <= 10 then
						local money = tonumber(vnxGetElementData ( player, "money" ))
						local wanteds = tonumber(vnxGetElementData(player, "wanteds"))
						local targetfrac = tonumber(vnxGetElementData(player, "fraktion"))
						local fine = 1000 * wanteds
						if evilFraction[targetfrac] then
							fine = 500 * wanteds
						end
						if fine > money then		
							vnxSetElementData ( player, "money", 0 )
						else
							vnxSetElementData ( player, "money", money - fine )
						end
						if vnxGetElementData ( player, "tied" ) then
							fadeCamera ( player, true, 0.5, 0, 0, 0 )
							toggleAllControls ( player, true )
						end
						local time = jailtimeperwanted*0.8*wanteds
						local bail = bailCosts[wanteds]
						if evilFraction[targetfrac] then
							time = jailtimeperwanted*0.6*wanteds
						end
						vnxSetElementData ( player, "jailtime", time )
						vnxSetElementData ( player, "bail", bail )
						vnxSetElementData ( player, "arrester", nil )
						vnxSetElementData ( player, "AnzahlImKnast", vnxGetElementData ( player, "AnzahlImKnast" ) + 1 )
						outputChatBox ( "Du hast dich mit "..bail.." $ Kaution für "..fine.." $ und "..time.." Minuten gestellt!", player, 0, 125, 0 )
						outputChatBox ( getPlayerName ( player ).." hat sich gestellt!", root, 0, 0, 150 )
						putPlayerInJail ( player )
						outputLog (  getPlayerName ( player ).." hat sich gestellt!", "knast" )
					else
						infobox ( player, "Du bist nicht\nam Marker!", 5000, 0, 200, 0 )
					end
				else
					infobox ( player, "Das Stellen\nist noch\ndeaktiviert!", 5000, 0, 200, 0 )
				end
			end
		else
			infobox ( player, "Du bist\nnoch im Knast!", 5000, 0, 200, 0 )
		end
	else
		infobox ( player, "Du wirst\nnicht gesucht!", 5000, 0, 200, 0 )
	end
end				
addCommandHandler ( "ergeben", stellen_func )
addCommandHandler ( "stellen", stellen_func )


function deaktiviereStellen ( player )
	if isCop ( player ) or isFBI ( player ) or isArmy ( player ) then
		if isOnDuty ( player ) then
			if stellenAn then
				stellenAn = false
				local playername = getPlayerName ( player )
				for playeritem, _ in pairs ( fraktionMembers[1] ) do
					outputChatBox ( "Das Stellen wurde von "..playername.." deaktiviert!", playeritem, 255, 0, 0 )
				end
				for playeritem, _ in pairs ( fraktionMembers[6] ) do
					outputChatBox ( "Das Stellen wurde von "..playername.." deaktiviert!", playeritem, 255, 0, 0 )
				end
				for playeritem, _ in pairs ( fraktionMembers[7] ) do
					outputChatBox ( "Das Stellen wurde von "..playername.." deaktiviert!", playeritem, 255, 0, 0 )
				end
				stellenTimer = setTimer ( function () stellenAn = true outputChatBox ("Man kann sich nun wieder stellen!", getRootElement(), 0, 0, 255) end, 10*1000*60, 1 )
			else
				stellenAn = true
				local playername = getPlayerName ( player )
				for playeritem, _ in pairs ( fraktionMembers[1] ) do
					outputChatBox ( "Das Stellen wurde von "..playername.." wieder aktiviert!", playeritem, 255, 0, 0 )
				end
				for playeritem, _ in pairs ( fraktionMembers[6] ) do
					outputChatBox ( "Das Stellen wurde von "..playername.." wieder aktiviert!", playeritem, 255, 0, 0 )
				end
				for playeritem, _ in pairs ( fraktionMembers[7] ) do
					outputChatBox ( "Das Stellen wurde von "..playername.." wieder aktiviert!", playeritem, 255, 0, 0 )
				end
				if isTimer (stellenTimer) then
					killTimer ( stellenTimer )
					stellenTimer = nil
				end
			end
		else
			infobox ( player, "Du bist\nnicht im Dienst!", 5000, 0, 200, 0 )
		end
	else
		infobox ( player, "Du bist kein\nStaatsfraktionist!", 5000, 0, 200, 0 )
	end
end
addCommandHandler ( "stellen", deaktiviereStellen )


local SFPrisonCarJail = createColCuboid ( -1594.0999755859, 712.20001220703, -7, -1585.9000244141+1594.0999755859, 720.40002441406-712.20001220703, 7 )
local LVPrisonCarJail = createColSphere ( 2279.3000488281, 2426.8000488281, 1, 2283.8000488281-2279.3000488281, 2435.1000976563-2426.8000488281, 9 )
local LSPrisonCarJail = createColSphere ( 1564.5, -1698.3000488281, 2, 1572.8000488281-1564.5, -1690.1999511719+1698.3000488281, 9 )

local function prisonCarHit ( hitElement, dim )
	if getElementType ( hitElement ) == "player" and dim then
		if vnxGetElementData ( hitElement, "wanteds" ) > 0 then
			arrest_func ( hitElement )
		end
	end
end
addEventHandler ( "onColShapeHit", SFPrisonCarJail, prisonCarHit )
addEventHandler ( "onColShapeHit", LVPrisonCarJail, prisonCarHit )
addEventHandler ( "onColShapeHit", LSPrisonCarJail, prisonCarHit )


